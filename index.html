<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Profile Manager</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f6f9; margin: 20px; }
.container { max-width: 1000px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
h1 { text-align: center; }
nav { text-align:center; margin-bottom: 15px; }
nav button { margin: 5px; padding: 8px 15px; border: none; background: #4CAF50; color: white; border-radius: 5px; cursor: pointer; }
nav button:hover { background: #45a049; }
input, select, button { padding: 8px; margin: 5px 0; width: 100%; }
table { width: 100%; border-collapse: collapse; margin-top: 15px; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
th { background: #4CAF50; color: white; }
.delete-btn { background: red; color: white; border: none; padding: 5px 10px; cursor: pointer; }
.delete-btn:hover { background: darkred; }
.hidden { display: none; }
.print-btn { background: #2196F3; color: white; border: none; padding: 5px 10px; cursor: pointer; }
.print-btn:hover { background: #1976D2; }
.fee-table { margin-top:20px; }
</style>
</head>
<body>

<div class="container">
<h1>Student Profile Manager</h1>

<nav>
  <button onclick="showSection('addSection')">Add Student</button>
  <button onclick="showSection('viewSection')">View Students</button>
  <button onclick="showSection('filterSection')">View Branch Wise</button>
  <button onclick="showSection('feeChartSection')">Year-wise Fees</button>
</nav>

<!-- Add Student Section -->
<div id="addSection" class="section">
  <h2>Add Student</h2>
  <input type="text" id="name" placeholder="Name">
  <input type="number" id="age" placeholder="Age">
  <input type="email" id="email" placeholder="Email">
  <input type="text" id="phone" placeholder="Phone">
  
  <select id="branch">
    <option value="">Select Branch</option>
    <option>Computer Science</option>
    <option>Civil</option>
    <option>Mechanical</option>
    <option>E&E</option>
    <option>EEE</option>
  </select>
  
  <select id="year" onchange="updateFee()">
    <option value="">Select Year</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
  </select>
  
  <select id="sem">
    <option value="">Select Semester</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>6</option>
  </select>

  <input type="number" id="fee" placeholder="Yearly Fees (Auto-Filled)" readonly>
  <input type="number" id="backFee" placeholder="Back Fees (if any)">
  <input type="number" id="totalFee" placeholder="Total Fees (Auto-Calculated)" readonly>

  <button onclick="addStudent()">Add Student</button>
</div>

<!-- View Students Section -->
<div id="viewSection" class="section hidden">
  <h2>All Students</h2>
  <button class="print-btn" onclick="printTable()">Print Students</button>
  <table id="studentTable">
    <thead>
      <tr>
        <th>Name</th><th>Age</th><th>Email</th><th>Phone</th>
        <th>Branch</th><th>Year</th><th>Sem</th>
        <th>Fees (₹)</th><th>Back Fees (₹)</th><th>Total (₹)</th><th>Action</th>
      </tr>
    </thead>
    <tbody id="studentList"></tbody>
  </table>
</div>

<!-- Filter by Branch -->
<div id="filterSection" class="section hidden">
  <h2>View Students Branch Wise</h2>
  <select id="branchFilter">
    <option value="">Select Branch</option>
    <option>Computer Science</option>
    <option>Civil</option>
    <option>Mechanical</option>
    <option>E&E</option>
    <option>EEE</option>
  </select>
  <select id="yearFilter">
    <option value="">Select Year</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
  </select>
  <select id="semFilter">
    <option value="">Select Semester</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>6</option>
  </select>
  <button onclick="filterStudents()">Filter</button>
  <button class="print-btn" onclick="printFiltered()">Print Branch Wise</button>
  
  <table id="filterTable">
    <thead>
      <tr>
        <th>Name</th><th>Age</th><th>Email</th><th>Phone</th>
        <th>Branch</th><th>Year</th><th>Sem</th>
        <th>Fees (₹)</th><th>Back Fees (₹)</th><th>Total (₹)</th>
      </tr>
    </thead>
    <tbody id="filterList"></tbody>
  </table>
</div>

<!-- Fee Chart Section -->
<div id="feeChartSection" class="section hidden">
  <h2>Year-Wise Fee Chart</h2>
  <table class="fee-table">
    <tr><th>Year</th><th>Fees (₹)</th></tr>
    <tr><td>1st Year</td><td id="fee1"></td></tr>
    <tr><td>2nd Year</td><td id="fee2"></td></tr>
    <tr><td>3rd Year</td><td id="fee3"></td></tr>
  </table>
</div>
</div>

<script>
const feeStructure = { "1": 25000, "2": 30000, "3": 35000 };

function showSection(sectionId) {
  document.querySelectorAll('.section').forEach(sec => sec.classList.add("hidden"));
  document.getElementById(sectionId).classList.remove("hidden");
  if (sectionId === 'viewSection') loadStudents();
  if (sectionId === 'feeChartSection') loadFeeChart();
}

function updateFee() {
  const year = document.getElementById("year").value;
  const fee = year ? feeStructure[year] : "";
  document.getElementById("fee").value = fee;
  calculateTotal();
}

function calculateTotal() {
  const fee = Number(document.getElementById("fee").value) || 0;
  const backFee = Number(document.getElementById("backFee").value) || 0;
  document.getElementById("totalFee").value = fee + backFee;
}
document.getElementById("backFee").addEventListener("input", calculateTotal);

function addStudent() {
  let student = {
    id: Date.now(),
    name: document.getElementById("name").value.trim(),
    age: document.getElementById("age").value.trim(),
    email: document.getElementById("email").value.trim(),
    phone: document.getElementById("phone").value.trim(),
    branch: document.getElementById("branch").value,
    year: document.getElementById("year").value,
    sem: document.getElementById("sem").value,
    fee: document.getElementById("fee").value,
    backFee: document.getElementById("backFee").value || 0,
    totalFee: document.getElementById("totalFee").value
  };

  if (!student.name || !student.age || !student.email || !student.phone || !student.branch || !student.year || !student.sem) {
    alert("Please fill all fields");
    return;
  }

  let students = JSON.parse(localStorage.getItem("students")) || [];
  students.push(student);
  localStorage.setItem("students", JSON.stringify(students));
  alert("Student Added Successfully!");
  document.querySelectorAll("#addSection input, #addSection select").forEach(el => el.value = "");
}

function loadStudents() {
  let students = JSON.parse(localStorage.getItem("students")) || [];
  let table = document.getElementById("studentList");
  table.innerHTML = "";
  students.forEach(s => {
    table.innerHTML += `<tr>
      <td>${s.name}</td>
      <td>${s.age}</td>
      <td>${s.email}</td>
      <td>${s.phone}</td>
      <td>${s.branch}</td>
      <td>${s.year}</td>
      <td>${s.sem}</td>
      <td>${s.fee}</td>
      <td>${s.backFee}</td>
      <td>${s.totalFee}</td>
      <td><button class="delete-btn" onclick="deleteStudent(${s.id})">Delete</button></td>
    </tr>`;
  });
}

function deleteStudent(id) {
  let students = JSON.parse(localStorage.getItem("students")) || [];
  students = students.filter(s => s.id !== id);
  localStorage.setItem("students", JSON.stringify(students));
  loadStudents();
}

function filterStudents() {
  let branch = document.getElementById("branchFilter").value;
  let year = document.getElementById("yearFilter").value;
  let sem = document.getElementById("semFilter").value;
  
  let students = JSON.parse(localStorage.getItem("students")) || [];
  let filtered = students.filter(s => 
    (branch ? s.branch === branch : true) &&
    (year ? s.year === year : true) &&
    (sem ? s.sem === sem : true)
  );
  
  let table = document.getElementById("filterList");
  table.innerHTML = "";
  filtered.forEach(s => {
    table.innerHTML += `<tr>
      <td>${s.name}</td>
      <td>${s.age}</td>
      <td>${s.email}</td>
      <td>${s.phone}</td>
      <td>${s.branch}</td>
      <td>${s.year}</td>
      <td>${s.sem}</td>
      <td>${s.fee}</td>
      <td>${s.backFee}</td>
      <td>${s.totalFee}</td>
    </tr>`;
  });
}

function printTable() {
  let divToPrint = document.getElementById("studentTable");
  let newWin = window.open("");
  newWin.document.write("<html><head><title>Print</title></head><body>");
  newWin.document.write(divToPrint.outerHTML);
  newWin.document.write("</body></html>");
  newWin.print();
  newWin.close();
}

function printFiltered() {
  let divToPrint = document.getElementById("filterTable");
  let newWin = window.open("");
  newWin.document.write("<html><head><title>Print</title></head><body>");
  newWin.document.write(divToPrint.outerHTML);
  newWin.document.write("</body></html>");
  newWin.print();
  newWin.close();
}

function loadFeeChart() {
  document.getElementById("fee1").innerText = feeStructure["1"];
  document.getElementById("fee2").innerText = feeStructure["2"];
  document.getElementById("fee3").innerText = feeStructure["3"];
}
</script>

</body>
</html>