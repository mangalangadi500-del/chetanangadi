<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Student Profile Creator</title>
  <style>
    :root {
      --bg: #f7fafc; --card: #fff; --muted: #6b7280; --accent: #2563eb;
      --border: #e6e9ef;
      font-family: Arial, sans-serif;
    }
    body { margin: 0; background: var(--bg); color: #111; }
    .container { max-width: 1100px; margin: 36px auto; padding: 20px; }
    h1 { font-size: 20px; margin: 0 0 10px; }
    h2 { font-size: 18px; margin-top: 0; }
    .card { background: var(--card); border-radius: 12px; padding: 14px; border: 1px solid var(--border); margin-bottom: 20px; }
    .controls, form { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    select, input[type="text"], input[type="number"], input[type="email"], input[type="tel"] {
      padding: 8px 10px; border: 1px solid var(--border); border-radius: 8px; background: #fff;
    }
    button { padding: 8px 12px; border-radius: 8px; border: 0; background: var(--accent); color: #fff; cursor: pointer; }
    button.ghost { background: #fff; color: var(--accent); border: 1px solid var(--border); }
    table { width: 100%; border-collapse: collapse; margin-top: 14px; }
    th, td { padding: 10px 8px; text-align: left; border-bottom: 1px solid #f1f3f6; font-size: 14px; }
    th { color: var(--muted); font-weight: 600; }
    tr:hover td { background: #fbfdff; }
    .small { font-size: 13px; color: var(--muted); }
    .footer { margin-top: 10px; color: var(--muted); font-size: 13px; }
    .modal-backdrop { position: fixed; inset: 0; background: rgba(2, 6, 23, 0.5); display: none; align-items: center; justify-content: center; padding: 18px; }
    .modal { width: 640px; max-width: 100%; background: #fff; border-radius: 10px; padding: 18px; border: 1px solid var(--border); }
    .modal h3 { margin: 0 0 6px 0; }
    .modal .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px; }
    .close-btn { background: #ef4444; color: #fff; border: none; padding: 6px 10px; border-radius: 8px; cursor: pointer; float: right; }
    @media (max-width: 640px) { .controls { flex-direction: column; align-items: stretch; } .modal .grid { grid-template-columns: 1fr; } }

    /* Print view - hide form and filters */
    @media print {
      form, .controls, .footer, .modal-backdrop { display: none !important; }
      table { border: 1px solid #000; }
      th, td { border: 1px solid #000; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Student Profile Creator</h1>

    <!-- Add Student Form -->
    <section class="card">
      <h2>Add New Student</h2>
      <form id="addStudentForm">
        <input type="text" id="name" placeholder="Full Name" required>
        <input type="number" id="year" placeholder="Year" min="1" max="4" required>
        <input type="number" id="sem" placeholder="Semester" min="1" max="8" required>
        <input type="text" id="branch" placeholder="Branch" required>
        <input type="email" id="email" placeholder="Email" required>
        <input type="tel" id="phone" placeholder="Phone" required>
        <input type="number" id="age" placeholder="Age" min="15" max="30">
        <input type="text" id="address" placeholder="Address">
        <button type="submit">Add Student</button>
      </form>
    </section>

    <!-- Filter + Table -->
    <section class="card">
      <div class="controls">
        <label class="small">Year:
          <select id="yearSelect"><option value="">All Years</option></select>
        </label>
        <label class="small">Semester:
          <select id="semSelect"><option value="">All Semesters</option></select>
        </label>
        <label class="small">Branch:
          <select id="branchSelect"><option value="">All Branches</option></select>
        </label>
        <input id="searchInput" type="text" placeholder="Search...">
        <button id="filterBtn">Apply Filters</button>
        <button id="resetBtn" class="ghost">Reset</button>
        <button id="viewAllBtn" class="ghost">View All</button>
        <button id="printBtn" class="ghost">ðŸ–¨ Print</button>
      </div>

      <table>
        <thead>
          <tr>
            <th>#</th><th>Name</th><th>Year</th><th>Sem</th><th>Branch</th><th>Email / Phone</th><th>Actions</th>
          </tr>
        </thead>
        <tbody id="studentsTbody"></tbody>
      </table>
      <div class="footer small" id="countInfo"></div>
    </section>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modalBackdrop">
    <div class="modal">
      <button class="close-btn" id="modalClose">Close</button>
      <h3 id="modalName"></h3>
      <div class="small" id="modalMeta"></div>
      <div class="grid" id="modalGrid"></div>
      <div style="margin-top:12px;"><strong>Address</strong><p id="modalAddress" class="small"></p></div>
    </div>
  </div>

  <script>
    const students = [
      {id:1,name:"Asha Rao",year:1,sem:1,branch:"CSE",email:"asha@example.com",phone:"+91-9876543210",age:18,address:"Bangalore"},
      {id:2,name:"Rohan Kumar",year:2,sem:3,branch:"ECE",email:"rohan@example.com",phone:"+91-9123456780",age:19,address:"Mysore"}
    ];
    const $ = id => document.getElementById(id);
    const uniqueSorted = arr => Array.from(new Set(arr)).sort((a,b)=>a-b);
    const escapeHtml = t => t ? t.replaceAll("&","&amp;").replaceAll("<","&lt;") : "";

    function populateFilters(){
      ["yearSelect","semSelect","branchSelect"].forEach(id=>{
        const el = $(id);
        while(el.options.length > 1) el.remove(1);
      });
      uniqueSorted(students.map(s=>s.year)).forEach(y=>$("yearSelect").append(new Option("Year "+y,y)));
      uniqueSorted(students.map(s=>s.sem)).forEach(s=>$("semSelect").append(new Option("Sem "+s,s)));
      Array.from(new Set(students.map(s=>s.branch))).sort().forEach(b=>$("branchSelect").append(new Option(b,b)));
    }

    function renderTable(list){
      const tbody = $("studentsTbody");
      tbody.innerHTML = "";
      if(!list.length){
        tbody.innerHTML = `<tr><td colspan="7" class="small">No students found.</td></tr>`;
      } else {
        list.forEach((s,i)=>{
          tbody.innerHTML += `<tr>
            <td>${i+1}</td>
            <td><strong>${escapeHtml(s.name)}</strong><div class="small">${s.age||""} yrs</div></td>
            <td>${s.year}</td><td>${s.sem}</td><td>${escapeHtml(s.branch)}</td>
            <td class="small">${escapeHtml(s.email)}<br>${escapeHtml(s.phone)}</td>
            <td><button class="viewBtn" data-id="${s.id}">View</button></td>
          </tr>`;
        });
      }
      $("countInfo").textContent = `Showing ${list.length} student(s)`;
      document.querySelectorAll(".viewBtn").forEach(btn=>btn.onclick=()=>openDetailModal(+btn.dataset.id));
    }

    function applyFilters(){
      let list = students.slice();
      if($("yearSelect").value) list = list.filter(s=>s.year==$("yearSelect").value);
      if($("semSelect").value) list = list.filter(s=>s.sem==$("semSelect").value);
      if($("branchSelect").value) list = list.filter(s=>s.branch==$("branchSelect").value);
      const q = $("searchInput").value.toLowerCase();
      if(q) list = list.filter(s=>Object.values(s).some(v=>String(v).toLowerCase().includes(q)));
      renderTable(list);
    }

    function openDetailModal(id){
      const s = students.find(st=>st.id===id);
      $("modalName").textContent = s.name;
      $("modalMeta").textContent = `ID: ${s.id} â€¢ ${s.branch} â€¢ Year ${s.year}, Sem ${s.sem}`;
      $("modalGrid").innerHTML = `<div><strong>Email</strong><div class="small">${s.email}</div></div>
                                  <div><strong>Phone</strong><div class="small">${s.phone}</div></div>
                                  <div><strong>Age</strong><div class="small">${s.age||"-"}</div></div>
                                  <div><strong>Branch</strong><div class="small">${s.branch}</div></div>`;
      $("modalAddress").textContent = s.address || "-";
      $("modalBackdrop").style.display = "flex";
    }

    function closeModal(){
      $("modalBackdrop").style.display = "none";
    }

    $("modalClose").addEventListener("click", closeModal);
    $("modalBackdrop").addEventListener("click", e=>{ if(e.target.id==="modalBackdrop") closeModal(); });

    $("filterBtn").onclick = applyFilters;
    $("resetBtn").onclick = ()=>{ $("yearSelect").value=""; $("semSelect").value=""; $("branchSelect").value=""; $("searchInput").value=""; renderTable(students); };
    $("viewAllBtn").onclick = ()=>renderTable(students);
    $("searchInput").onkeyup = e=>{ if(e.key==="Enter" || e.target.value==="") applyFilters(); };
    $("printBtn").onclick = ()=>window.print();

    $("addStudentForm").addEventListener("submit", e=>{
      e.preventDefault();
      const newStudent = {
        id: students.length ? Math.max(...students.map(s=>s.id))+1 : 1,
        name: $("name").value.trim(),
        year: +$("year").value,
        sem: +$("sem").value,
        branch: $("branch").value.trim(),
        email: $("email").value.trim(),
        phone: $("phone").value.trim(),
        age: $("age").value ? +$("age").value : "",
        address: $("address").value.trim()
      };
      students.push(newStudent);
      populateFilters();
      renderTable(students);
      e.target.reset();
    });

    window.onload = ()=>{ populateFilters(); renderTable(students); };
  </script>
</body>
</html>
